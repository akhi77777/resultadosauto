<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Digital Signage - Tabela Google Sheets (Zoom Reduzido)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* Remove margens e configura a página para tela cheia */
    html, body {
      margin: 0;
      padding: 0;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      background: #000;
      font-family: Arial, sans-serif;
    }

    /* 
      Contêiner principal que ocupa toda a tela.
      Ele será o responsável por "recortar" o iframe.
    */
    #clipper {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden; /* Isso é crucial para esconder as partes indesejadas */
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* 
      Wrapper para aplicar o zoom e centralização
    */
    #zoomWrapper {
      position: absolute;
      /* Dimensões baseadas na nossa análise anterior */
      width: 1788px;   /* Largura real da tabela */
      height: 1013px;  /* Altura total da aba publicada (incluindo cabeçalho e rodapé) */
      
      /* Aplica o zoom e centraliza */
      transform: scale(0.45) translate(-50%, -50%);
      transform-origin: 0 0; /* Garante que a escala seja aplicada a partir do canto superior esquerdo */
      top: 50%;
      left: 50%;
    }

    /* 
      O iframe que carrega a planilha.
      Usamos um top negativo para cortar o cabeçalho.
    */
    #sheetFrame {
      border: none;
      position: absolute;
      width: 100%;   /* Ocupa 100% do zoomWrapper */
      height: 100%;  /* Ocupa 100% do zoomWrapper */
      top: -29px;      /* Corta o cabeçalho (29px) */
      left: 0;         /* Alinha à esquerda */
    }

    /* Indicador de última atualização */
    #updateIndicator {
      position: fixed;
      bottom: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.7);
      color: #fff;
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 12px;
      z-index: 100;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    #updateIndicator.show {
      opacity: 1;
    }
  </style>
</head>
<body>

  <!-- Contêiner que recorta o iframe -->
  <div id="clipper">
    <div id="zoomWrapper">
      <iframe id="sheetFrame"
        src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTTOTFC_1GFgzJXd8lBR5ON5f8xQUn09vm8DR8FlA4n8ffaPknsTw1YQhhxSIW4Yz1Ybeu_OgqAMT12/pubhtml?gid=471953676&single=true&widget=false&headers=false&chrome=false">
      </iframe>
    </div>
  </div>

  <!-- Indicador de atualização -->
  <div id="updateIndicator">
    Última atualização: <span id="updateTime"></span>
  </div>

  <script>
    const updateIndicator = document.getElementById("updateIndicator" );
    const updateTime = document.getElementById("updateTime");

    // Função para atualizar o indicador de tempo
    function updateTimeIndicator() {
      const now = new Date();
      const timeString = now.toLocaleTimeString("pt-BR", { 
        hour: "2-digit", 
        minute: "2-digit" 
      });
      updateTime.textContent = timeString;
      
      updateIndicator.classList.add("show");
      setTimeout(() => {
        updateIndicator.classList.remove("show");
      }, 3000);
    }

    // Inicializa o indicador de tempo ao carregar
    window.addEventListener("load", updateTimeIndicator);

    // Auto-reload a cada 5 minutos com indicador
    setInterval(function() {
      console.log("Recarregando página para atualizar dados...");
      window.location.reload();
    }, 5 * 60 * 1000); // 5 minutos em milissegundos
  </script>

</body>
</html>


