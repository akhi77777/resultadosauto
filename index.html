<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Tabela Digital Signage - Solução Otimizada</title>
  <style>
    /* Remove margens e configura a página para tela cheia */
    html, body {
      margin: 0;
      padding: 0;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      background: #000;
    }

    /* 
      Contêiner principal que ocupará toda a tela.
      Usamos flexbox para centralizar o conteúdo.
    */
    #container {
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    /* 
      O iframe que carrega a planilha.
      A chave é deixá-lo responsivo e usar zoom para ajustar o tamanho.
    */
    #sheetFrame {
      border: none;
      width: 100%;
      height: 100%;
      
      /* 
        Aplicamos uma transformação para:
        1. Cortar o cabeçalho (29px para cima)
        2. Escalar o conteúdo para preencher a tela
      */
      transform-origin: top left;
      position: relative;
    }

    /* 
      Wrapper para aplicar o corte do cabeçalho
    */
    #frameWrapper {
      width: 100%;
      height: 100%;
      overflow: hidden;
      position: relative;
    }
  </style>
</head>
<body>

  <div id="container">
    <div id="frameWrapper">
      <iframe id="sheetFrame"
        src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTTOTFC_1GFgzJXd8lBR5ON5f8xQUn09vm8DR8FlA4n8ffaPknsTw1YQhhxSIW4Yz1Ybeu_OgqAMT12/pubhtml?gid=471953676&single=true&widget=false&headers=false&chrome=false">
      </iframe>
    </div>
  </div>

  <script>
    function adjustDisplay( ) {
      const iframe = document.getElementById("sheetFrame");
      const wrapper = document.getElementById("frameWrapper");
      
      // Obtém as dimensões da tela
      const screenWidth = window.innerWidth;
      const screenHeight = window.innerHeight;
      
      // Altura do cabeçalho que queremos cortar (descoberto na análise: 29px)
      const headerHeight = 29;
      
      // Altura do rodapé que queremos cortar (estimativa: 20px para "Published by Google")
      const footerHeight = 20;
      
      // Calcula a altura útil disponível
      const usableHeight = screenHeight;
      
      // Ajusta o iframe para compensar o corte do cabeçalho
      iframe.style.marginTop = `-${headerHeight}px`;
      
      // Aumenta a altura do iframe para compensar os cortes
      iframe.style.height = `calc(100% + ${headerHeight + footerHeight}px)`;
      
      // O Google Sheets se adaptará automaticamente à largura disponível
      iframe.style.width = "100%";
    }

    // Aplica os ajustes quando a página carrega
    window.addEventListener("load", function() {
      // Aguarda um pouco para o iframe carregar completamente
      setTimeout(adjustDisplay, 1000);
    });
    
    // Reaplica os ajustes se a janela for redimensionada
    window.addEventListener("resize", adjustDisplay);
    
    // Recarrega a página a cada 5 minutos para manter os dados atualizados
    setInterval(function() {
      window.location.reload();
    }, 5 * 60 * 1000); // 5 minutos em milissegundos
  </script>

</body>
</html>
