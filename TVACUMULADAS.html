<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>TABELA RESULTADOS CAIXA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* Configurações básicas para tela cheia */
    html, body {
      margin: 0;
      padding: 0;
      width: 100vw;
      height: 100vh;
      overflow: hidden; /* Impede barras de rolagem na página */
      background: #000;
      font-family: Arial, sans-serif;
      /* Centraliza o contêiner do iframe */
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* Contêiner que vai segurar e escalar o iframe */
    #container {
      /* Define o tamanho do contêiner. Usaremos a resolução da sua TV (Full HD) como base. */
      width: 1920px;
      height: 1080px;
      
      /* A mágica acontece aqui: escalamos o contêiner (e seu conteúdo) para caber na tela */
      transform: scale(var(--zoom-level, 0.71)); /* O valor do zoom será ajustado via JS */
      transform-origin: center center; /* O zoom é aplicado a partir do centro */
      
      /* Garante que o iframe dentro dele não tenha bordas ou problemas de layout */
      border: none;
      overflow: hidden;
    }

    /* O iframe que carrega a planilha */
    #sheetFrame {
      width: 100%;
      height: 100%;
      border: none;
    }

    /* Indicador de última atualização (sem alterações) */
    #updateIndicator {
      position: fixed;
      bottom: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.7);
      color: #fff;
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 12px;
      z-index: 100;
    }
  </style>
</head>
<body>

  <!-- Contêiner que será escalado -->
  <div id="container">
    <iframe id="sheetFrame" src="https://docs.google.com/spreadsheets/d/e/2PACX-1vREcpkPb9guZ_Iq5ZqHK-ceBFpCLM1pMq5lzTlOF4EtagfEUwQND93tEL9h_YjnmkW7XTvU9qUlsCpI/pubhtml?gid=0&single=true&widget=false&headers=false&chrome=false&rm=minimal">
    </iframe>
  </div>

  <!-- Indicador de atualização -->
  <div id="updateIndicator">
    Última atualização: <span id="updateTime"></span>
  </div>

  <script>
    function adjustZoom( ) {
      const container = document.getElementById('container');
      
      // Dimensões base do nosso contêiner (resolução alvo)
      const baseWidth = 1920;
      const baseHeight = 1080;

      // Dimensões atuais da tela (viewport)
      const screenWidth = window.innerWidth;
      const screenHeight = window.innerHeight;

      // Calcula o fator de zoom necessário para que o contêiner caiba na tela
      // Compara a proporção da largura e da altura e usa o menor valor para não cortar conteúdo
      const scaleX = screenWidth / baseWidth;
      const scaleY = screenHeight / baseHeight;
      const zoomLevel = Math.min(scaleX, scaleY);

      // Define a variável CSS '--zoom-level' com o valor calculado
      document.documentElement.style.setProperty('--zoom-level', zoomLevel);
    }

    // Função para atualizar o indicador de tempo
    function updateTimeIndicator() {
      const updateIndicator = document.getElementById("updateIndicator");
      const updateTime = document.getElementById("updateTime");
      const now = new Date();
      const timeString = now.toLocaleTimeString("pt-BR", { hour: "2-digit", minute: "2-digit" });
      updateTime.textContent = timeString;
    }

    // Ajusta o zoom quando a página carrega e quando a janela é redimensionada
    window.addEventListener("load", () => {
      adjustZoom();
      updateTimeIndicator();
    });
    window.addEventListener("resize", adjustZoom);

    // Recarrega a página a cada 5 minutos para buscar novos dados
    setInterval(function() {
      console.log("Recarregando página para atualizar dados...");
      window.location.reload();
    }, 5 * 60 * 1000); // 5 minutos
  </script>

</body>
</html>
